<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Luxe Micro Estates – Construction Survey Estimator</title>
  <style>
    :root {
      --brand: #5b3b24;
      --ink: #1f2937;
      --paper: #fdf7ee;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      color: var(--ink);
      background-color: var(--paper);
      padding-bottom: 3rem;
    }
    header {
      background-color: var(--brand);
      color: #fff;
      padding: 1rem;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header .logo {
      max-width: 150px;
      margin-bottom: 0.5rem;
    }
    h1 {
      margin: 0;
      font-size: 1.75rem;
    }
    main {
      max-width: 900px;
      margin: 0 auto;
      padding: 1rem;
    }
    section.card {
      background: #fff;
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    section.card h2 {
      margin-top: 0;
      margin-bottom: 0.75rem;
      font-size: 1.25rem;
      color: var(--brand);
    }
    label {
      font-weight: 600;
      margin-bottom: 0.25rem;
      display: block;
    }
    input[type="text"],
    input[type="number"],
    input[type="date"],
    select {
      width: 100%;
      padding: 0.5rem;
      margin-bottom: 0.75rem;
      border: 1px solid #cbd5e0;
      border-radius: 0.25rem;
    }
    input[type="checkbox"] {
      margin-right: 0.5rem;
    }
    .row {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    @media (min-width: 600px) {
      .row {
        flex-direction: row;
      }
      .row .col {
        flex: 1;
      }
    }
    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 720px;
    }
    th, td {
      border: 1px solid #e2e8f0;
      padding: 0.5rem;
    }
    th {
      background-color: var(--brand);
      color: #fff;
      text-align: left;
    }
    td.text-right, th.text-right {
      text-align: right;
    }
    .summary-container {
      overflow-x: auto;
    }
    button {
      background-color: var(--brand);
      color: #fff;
      border: none;
      padding: 0.6rem 1rem;
      border-radius: 0.25rem;
      cursor: pointer;
    }
    button:hover {
      opacity: 0.9;
    }
    footer {
      text-align: center;
      margin-top: 2rem;
    }
    footer .logo {
      max-width: 120px;
    }
  </style>
</head>
<body>
  <header>
    <!-- Embed the Luxe logo inline as a data URI so it always renders correctly -->
    <img src="45CD22F1-D52E-495E-B12E-508CF92E0753.jpeg" alt="Luxe Logo" class="logo" />
    <h1>Construction Survey Estimator</h1>
  </header>
  <main>
    <section class="card">
      <h2>Customer Information</h2>
      <div class="row">
        <div class="col">
          <label for="customer-name">Name</label>
          <input type="text" id="customer-name" placeholder="Customer name" />
        </div>
        <div class="col">
          <label for="customer-phone">Phone</label>
          <input type="text" id="customer-phone" placeholder="Phone number" />
        </div>
      </div>
      <div class="row">
        <div class="col">
          <label for="customer-address">Address</label>
          <input type="text" id="customer-address" placeholder="Address" />
        </div>
        <div class="col">
          <label for="survey-date">Date</label>
          <input type="date" id="survey-date" />
        </div>
      </div>
      <div>
        <label for="customer-email">Email (optional)</label>
        <input type="text" id="customer-email" placeholder="Email" />
      </div>
    </section>
    <section class="card">
      <h2>Setup Selection</h2>
      <label for="home-size">Home Size</label>
      <select id="home-size">
        <option value="20x20">20ft × 20ft</option>
        <option value="20x30">20ft × 30ft</option>
        <option value="20x40">20ft × 40ft</option>
      </select>
      <label>
        <input type="checkbox" id="setup-trailer" /> Setup on Trailer (adds $1,750)
      </label>
    </section>

    <!-- Rate adjustment section allowing surveyors to tweak per‑foot pricing for each utility. -->
    <section class="card">
      <h2>Rate Adjustments</h2>
      <p style="margin-bottom:0.5rem; font-size:0.9rem; color:#555">Adjust the default per‑foot rates and sub‑panel fee as needed. Values below are used to calculate costs.</p>
      <div class="grid" style="display:flex; flex-wrap:wrap; gap:1rem;">
        <div style="flex:1; min-width:180px;">
          <label for="rate-electrical-240">Electrical 240V rate ($/ft)</label>
          <!-- Increase the default electrical rate to reflect higher material costs; surveyors can still adjust -->
          <input type="number" id="rate-electrical-240" min="0" step="0.01" value="65" />
        </div>
        <div style="flex:1; min-width:180px;">
          <label for="rate-electrical-110">Electrical 110V rate ($/ft)</label>
          <!-- Increase the default 110V rate as well so electrical pricing is clearly above water and sewer -->
          <input type="number" id="rate-electrical-110" min="0" step="0.01" value="55" />
        </div>
        <div style="flex:1; min-width:180px;">
          <label for="rate-electrical-subpanel">Sub‑Panel Fee ($)</label>
          <input type="number" id="rate-electrical-subpanel" min="0" step="0.01" value="600" />
        </div>
        <div style="flex:1; min-width:180px;">
          <label for="rate-water">Water line rate ($/ft)</label>
          <input type="number" id="rate-water" min="0" step="0.01" value="21.62" />
        </div>
        <div style="flex:1; min-width:180px;">
          <label for="rate-sewer">Sewer line rate ($/ft)</label>
          <input type="number" id="rate-sewer" min="0" step="0.01" value="36" />
        </div>
        <div style="flex:1; min-width:180px;">
          <label for="rate-septic-extra">Septic extra leach rate ($/ft)</label>
          <!-- default is $1500 per 100ft → $15 per foot -->
          <input type="number" id="rate-septic-extra" min="0" step="0.01" value="15" />
        </div>
        <div style="flex:1; min-width:180px;">
          <label for="rate-trench">Trenching rate ($/ft)</label>
          <input type="number" id="rate-trench" min="0" step="0.01" value="15" />
        </div>
        <div style="flex:1; min-width:180px;">
          <label for="rate-machine-day">Trenching machine day rate ($/day)</label>
          <input type="number" id="rate-machine-day" min="0" step="1" value="400" />
        </div>
      </div>
    </section>
    <section class="card">
      <h2>Electrical</h2>
      <label for="electrical-type">Installation Type</label>
      <select id="electrical-type">
        <option value="none">None</option>
        <option value="240">240V to Sub-Panel (then 110V to Home)</option>
        <option value="110">Direct 110V from Main Panel</option>
      </select>
      <!-- Always display a single input for the total electrical run length -->
      <div id="electrical-run-container" style="margin-top: 0.5rem;">
        <label for="electrical-feet">Electrical Run Length (ft)</label>
        <input type="number" id="electrical-feet" min="0" step="1" placeholder="0" />
      </div>
    </section>
    <section class="card">
      <h2>Water</h2>
      <!-- Water connection type selection -->
      <label for="water-type">Water Connection</label>
      <select id="water-type">
        <option value="spigot">Backyard spigot (standard run)</option>
        <option value="bathroom">Connect to front house bathroom (+$1,500)</option>
      </select>
      <label for="water-feet">Water Line Length (ft)</label>
      <input type="number" id="water-feet" min="0" step="1" placeholder="0" />
    </section>
    <section class="card">
      <h2>Sewer & Septic</h2>
      <!-- Separate inputs for sewer and septic. Most customers will only need a sewer line. -->
      <label for="sewer-feet">Sewer Line Length (ft)</label>
      <input type="number" id="sewer-feet" min="0" step="1" placeholder="0" />
      <hr style="margin:1rem 0; border:none; border-top:1px dashed #e2e8f0;">
      <label for="septic-size">Septic Tank Size</label>
      <select id="septic-size">
        <option value="">None</option>
        <option value="1000">1,000 Gallon (up to 2 homes) – $9,750</option>
        <option value="1200">1,200 Gallon (up to 3 homes) – $10,450</option>
        <option value="1500">1,500 Gallon (up to 4 homes) – $11,250</option>
      </select>
      <label for="septic-leach">Extra Leach Line (feet beyond included length)</label>
      <input type="number" id="septic-leach" min="0" step="1" placeholder="0" />
    </section>
    <section class="card">
      <h2>Trenching</h2>
      <label for="trench-feet">Trenching Length (ft)</label>
      <input type="number" id="trench-feet" min="0" step="1" placeholder="0" />
    </section>

    <!-- Additional work section for custom tasks -->
    <section class="card">
      <h2>Additional Work</h2>
      <label for="additional-desc">Description (optional)</label>
      <input type="text" id="additional-desc" placeholder="Description" />
      <label for="additional-cost">Additional Work Cost ($)</label>
      <input type="number" id="additional-cost" min="0" step="0.01" placeholder="0" />
    </section>
    <section class="card">
      <h2>Summary</h2>
      <div class="summary-container">
        <table id="summary-table">
          <thead>
            <tr>
              <th>Category</th>
              <th class="text-right">Cost</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
          <tfoot>
            <tr>
              <th>Profit (20% margin)</th>
              <th id="summary-profit" class="text-right">$0.00</th>
            </tr>
            <tr>
              <th>Total Price</th>
              <th id="summary-total" class="text-right">$0.00</th>
            </tr>
          </tfoot>
        </table>
      </div>
    </section>
    <div style="display:flex; gap:1rem; justify-content:flex-end; margin-bottom:2rem;">
      <button id="calculate">Calculate</button>
      <button id="generate-pdf">Generate PDF</button>
    </div>
    <footer>
      <img src="45CD22F1-D52E-495E-B12E-508CF92E0753.jpeg" alt="Luxe Logo" class="logo" />
    </footer>
  </main>
  <script>
    const RATES = {
      setup: { '20x20': 5500, '20x30': 6000, '20x40': 6500 },
      trailerExtra: 1750,
      // Updated baseline rates for electrical to reflect higher material requirements (these
      // serve as fallbacks if the surveyor does not adjust the rate in the UI)
      // Updated default electrical rates to better reflect multiple conductors required per run;
      // these values are slightly higher than sewer/water rates but can be adjusted by the surveyor.
      // Increase default electrical rates and sub‑panel fee to better reflect
      // the higher material and labor requirements for electrical runs. A
      // 240V installation requires two hots and a neutral (three conductors),
      // while a 110V installation uses two conductors. These baseline rates
      // serve as fallbacks and are still adjustable via the Rate Adjustments
      // section.  The sub‑panel fee reflects the cost of providing and
      // installing the sub‑panel itself before markup.
      electrical: { '240': 65, '110': 55, 'subPanelFee': 600 },
      water: 21.62,
      sewer: 36,
      septic: { '1000': 9750, '1200': 10450, '1500': 11250, 'extraLeach': 1500 },
      trenching: { perFoot: 15, machineDay: 400, feetPerDay: 200 },
      profitMargin: 0.20
    };
    function formatCurrency(value) {
      return '$' + value.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
    }
    function calculateSetup() {
      const size = document.getElementById('home-size').value;
      let cost = RATES.setup[size] || 0;
      if (document.getElementById('setup-trailer').checked) {
        cost += RATES.trailerExtra;
      }
      return cost;
    }
    // Calculate electrical cost based on selected installation type and total run length.
    // We use a single run-length input (electrical-feet) regardless of type. When 240V is
    // selected, a sub‑panel fee is applied if there is any run length; for 110V there is no
    // sub‑panel fee. Rates per foot come from the survey guides: $32.26/ft for 240V
    // installations and $30.83/ft for direct 110V runs【813715599269414†L13-L31】.
    function calculateElectrical() {
      const type = document.getElementById('electrical-type').value;
      const ft = parseFloat(document.getElementById('electrical-feet').value) || 0;
      if (!ft || type === 'none') return 0;
      // Fetch adjustable rates from inputs if provided, otherwise fall back to defaults
      const rate240 = parseFloat(document.getElementById('rate-electrical-240').value) || RATES.electrical['240'];
      const rate110 = parseFloat(document.getElementById('rate-electrical-110').value) || RATES.electrical['110'];
      const subPanelFee = parseFloat(document.getElementById('rate-electrical-subpanel').value) || RATES.electrical.subPanelFee;
      let cost = 0;
      // When running 240V to a sub‑panel we need multiple conductors (two hots and a neutral),
      // effectively tripling the footage. For direct 110V runs we need a hot and neutral (2 conductors).
      if (type === '240') {
        const conductorMultiplier = 3;
        cost = ft * conductorMultiplier * rate240;
        // Apply the sub‑panel fee once if any run length is specified
        cost += subPanelFee;
      } else if (type === '110') {
        const conductorMultiplier = 2;
        cost = ft * conductorMultiplier * rate110;
      }
      return cost;
    }
    function calculateWater() {
      const ft = parseFloat(document.getElementById('water-feet').value) || 0;
      // Determine type of water connection (spigot vs bathroom)
      const waterTypeEl = document.getElementById('water-type');
      const type = waterTypeEl ? waterTypeEl.value : 'spigot';
      // Read adjustable water rate from the rate adjustments section. If not set, fall back to default.
      const rateWaterInput = document.getElementById('rate-water');
      const rateWater = rateWaterInput ? parseFloat(rateWaterInput.value) || RATES.water : RATES.water;
      let cost = ft * rateWater;
      // If connecting to bathroom, add a flat fee of $1500 (only if there is some run length)
      if (type === 'bathroom' && ft > 0) {
        cost += 1500;
      }
      return cost;
    }
    // Calculate separate sewer and septic costs.  Sewer is billed per foot; septic is a flat fee by tank size
    // with optional additional leach line cost.  If no septic size is selected, cost is zero.
    function calculateSewer() {
      const ft = parseFloat(document.getElementById('sewer-feet').value) || 0;
      const rateSewerInput = document.getElementById('rate-sewer');
      const rateSewer = rateSewerInput ? parseFloat(rateSewerInput.value) || RATES.sewer : RATES.sewer;
      return ft * rateSewer;
    }
    function calculateSeptic() {
      const size = document.getElementById('septic-size').value;
      if (!size) return 0;
      let cost = RATES.septic[size] || 0;
      const extraFeet = parseFloat(document.getElementById('septic-leach').value) || 0;
      if (extraFeet > 0) {
        // Use adjustable per‑foot rate for extra leach lines; default to RATES.septic.extraLeach/100 ($15/ft)
        const rateExtraInput = document.getElementById('rate-septic-extra');
        const rateExtra = rateExtraInput ? parseFloat(rateExtraInput.value) || (RATES.septic.extraLeach / 100) : (RATES.septic.extraLeach / 100);
        // Compute extra cost per foot
        cost += extraFeet * rateExtra;
      }
      return cost;
    }
    function calculateTrenching() {
      const ft = parseFloat(document.getElementById('trench-feet').value) || 0;
      if (ft <= 0) return 0;
      // Pull adjustable per‑foot and machine day rates from the rate adjustments section
      const rateTrenchInput = document.getElementById('rate-trench');
      const rateMachineInput = document.getElementById('rate-machine-day');
      const rateTrench = rateTrenchInput ? parseFloat(rateTrenchInput.value) || RATES.trenching.perFoot : RATES.trenching.perFoot;
      const rateMachine = rateMachineInput ? parseFloat(rateMachineInput.value) || RATES.trenching.machineDay : RATES.trenching.machineDay;
      const costFeet = ft * rateTrench;
      const days = Math.ceil(ft / RATES.trenching.feetPerDay);
      const machine = days * rateMachine;
      return costFeet + machine;
    }
    function calculateTotals() {
      const setup = calculateSetup();
      const electrical = calculateElectrical();
      const water = calculateWater();
      const sewer = calculateSewer();
      const septic = calculateSeptic();
      const trench = calculateTrenching();
      // Additional work cost entered by user
      const additional = parseFloat(document.getElementById('additional-cost').value) || 0;
      const markupFactor = 1 + RATES.profitMargin;
      // Base total for categories subject to markup (exclude setup)
      const nonSetupBaseTotal = electrical + water + sewer + septic + trench + additional;

      // Calculate profit on categories subject to markup (20% of base cost)
      const nonSetupProfit = nonSetupBaseTotal * RATES.profitMargin;

      // Calculate profit portion embedded in the setup price. Since setup pricing
      // already includes a 20% margin, derive the embedded profit using the
      // relationship price = cost * (1 + margin). Profit = price - cost.
      // cost = price / (1 + margin)
      // profit = price - cost = price * (margin / (1 + margin))
      const setupProfit = setup * (RATES.profitMargin / (1 + RATES.profitMargin));

      return {
        // Setup already includes margin in its rate; do not apply additional markup
        setup: setup,
        electrical: electrical * markupFactor,
        water: water * markupFactor,
        sewer: sewer * markupFactor,
        septic: septic * markupFactor,
        trench: trench * markupFactor,
        additional: additional * markupFactor,
        // Total price: setup (with margin built-in) plus other categories with markup
        total: setup + nonSetupBaseTotal * markupFactor,
        // Profit is the margin earned on categories subject to markup plus
        // the embedded profit portion within the setup price
        profit: nonSetupProfit + setupProfit,
        // Base total for reference (cost before markup): cost of setup plus
        // other categories before markup
        baseTotal: (setup / markupFactor) + nonSetupBaseTotal
      };
    }
    function updateSummary() {
      const totals = calculateTotals();
      const tbody = document.querySelector('#summary-table tbody');
      tbody.innerHTML = '';
      // Setup cost
      if (totals.setup > 0) {
        const row = document.createElement('tr');
        row.innerHTML = '<td>Setup</td><td class="text-right">' + formatCurrency(totals.setup) + '</td>';
        tbody.appendChild(row);
      }
      // Electrical cost
      if (totals.electrical > 0) {
        const row = document.createElement('tr');
        row.innerHTML = '<td>Electrical</td><td class="text-right">' + formatCurrency(totals.electrical) + '</td>';
        tbody.appendChild(row);
      }
      // Water cost
      if (totals.water > 0) {
        const row = document.createElement('tr');
        row.innerHTML = '<td>Water</td><td class="text-right">' + formatCurrency(totals.water) + '</td>';
        tbody.appendChild(row);
      }
      // Sewer cost
      if (totals.sewer > 0) {
        const row = document.createElement('tr');
        row.innerHTML = '<td>Sewer</td><td class="text-right">' + formatCurrency(totals.sewer) + '</td>';
        tbody.appendChild(row);
      }
      // Septic cost
      if (totals.septic > 0) {
        const row = document.createElement('tr');
        row.innerHTML = '<td>Septic</td><td class="text-right">' + formatCurrency(totals.septic) + '</td>';
        tbody.appendChild(row);
      }
      // Trenching cost
      if (totals.trench > 0) {
        const row = document.createElement('tr');
        row.innerHTML = '<td>Trenching</td><td class="text-right">' + formatCurrency(totals.trench) + '</td>';
        tbody.appendChild(row);
      }
      // Additional work cost (with optional description)
      const additionalDesc = document.getElementById('additional-desc').value.trim();
      if (totals.additional > 0) {
        const row = document.createElement('tr');
        let label = 'Additional Work';
        if (additionalDesc) label += ' – ' + additionalDesc;
        row.innerHTML = '<td>' + label + '</td><td class="text-right">' + formatCurrency(totals.additional) + '</td>';
        tbody.appendChild(row);
      }
      // Update profit (20% margin on markup categories) display
      document.getElementById('summary-profit').textContent = formatCurrency(totals.profit);
      // Update total
      document.getElementById('summary-total').textContent = formatCurrency(totals.total);
    }
    function showHideInputs() {
      // We removed the separate 240/110 inputs in favour of a single run length input,
      // so there's nothing to show or hide here. This function remains for backwards
      // compatibility but does not perform any DOM manipulation.
      return;
    }
    // Attach event listeners
    document.getElementById('electrical-type').addEventListener('change', showHideInputs);
    // Removed sewer-type element; no event listener needed
    const inputsToWatch = [
      'home-size',
      'setup-trailer',
      'electrical-feet',
      'water-feet',
      'water-type',
      'sewer-feet',
      'septic-size',
      'septic-leach',
      'trench-feet',
      'electrical-type',
      'additional-cost',
      'additional-desc'
      ,
      // rate adjustment inputs
      'rate-electrical-240',
      'rate-electrical-110',
      'rate-electrical-subpanel',
      'rate-water',
      'rate-sewer',
      'rate-septic-extra',
      'rate-trench',
      'rate-machine-day'
    ];
    inputsToWatch.forEach(function(id) {
      const el = document.getElementById(id);
      if (el) {
        el.addEventListener('input', updateSummary);
        el.addEventListener('change', updateSummary);
      }
    });
    document.getElementById('calculate').addEventListener('click', function() {
      updateSummary();
      alert('Summary updated. See the summary table below.');
    });
    function generatePDF() {
      updateSummary();
      const totals = calculateTotals();
      const name = document.getElementById('customer-name').value;
      const phone = document.getElementById('customer-phone').value;
      const address = document.getElementById('customer-address').value;
      const email = document.getElementById('customer-email').value;
      const dateVal = document.getElementById('survey-date').value;
      const dateStr = dateVal ? dateVal : new Date().toLocaleDateString();
      let html = '';
      // PDF header: personalize for the customer and remove company branding
      html += '<h1 style="text-align:center">Survey Estimate for ' + (name ? name : 'Client') + '</h1>';
      html += '<h2 style="text-align:center">Construction Survey Estimate</h2>';
      html += '<p><strong>Date:</strong> ' + dateStr + '</p>';
      html += '<p><strong>Customer Name:</strong> ' + name + '<br>';
      html += '<strong>Phone:</strong> ' + phone + '<br>';
      html += '<strong>Address:</strong> ' + address + '<br>';
      if (email) html += '<strong>Email:</strong> ' + email + '<br>';
      html += '</p>';
      html += '<table style="width:100%; border-collapse:collapse">';
      html += '<tr><th style="border:1px solid #ccc; padding:6px">Category</th><th style="border:1px solid #ccc; padding:6px; text-align:right">Cost</th></tr>';
      if (totals.setup > 0) html += '<tr><td style="border:1px solid #ccc; padding:6px">Setup</td><td style="border:1px solid #ccc; padding:6px; text-align:right">' + formatCurrency(totals.setup) + '</td></tr>';
      if (totals.electrical > 0) html += '<tr><td style="border:1px solid #ccc; padding:6px">Electrical</td><td style="border:1px solid #ccc; padding:6px; text-align:right">' + formatCurrency(totals.electrical) + '</td></tr>';
      if (totals.water > 0) html += '<tr><td style="border:1px solid #ccc; padding:6px">Water</td><td style="border:1px solid #ccc; padding:6px; text-align:right">' + formatCurrency(totals.water) + '</td></tr>';
      // Sewer and septic are now separate categories
      if (totals.sewer > 0) {
        html += '<tr><td style="border:1px solid #ccc; padding:6px">Sewer</td><td style="border:1px solid #ccc; padding:6px; text-align:right">' + formatCurrency(totals.sewer) + '</td></tr>';
      }
      if (totals.septic > 0) {
        html += '<tr><td style="border:1px solid #ccc; padding:6px">Septic</td><td style="border:1px solid #ccc; padding:6px; text-align:right">' + formatCurrency(totals.septic) + '</td></tr>';
      }
      if (totals.trench > 0) html += '<tr><td style="border:1px solid #ccc; padding:6px">Trenching</td><td style="border:1px solid #ccc; padding:6px; text-align:right">' + formatCurrency(totals.trench) + '</td></tr>';
      // Additional work row if applicable
      var adDesc = document.getElementById('additional-desc').value.trim();
      if (totals.additional && totals.additional > 0) {
        var adLabel = 'Additional Work';
        if (adDesc) adLabel += ' – ' + adDesc;
        html += '<tr><td style="border:1px solid #ccc; padding:6px">' + adLabel + '</td><td style="border:1px solid #ccc; padding:6px; text-align:right">' + formatCurrency(totals.additional) + '</td></tr>';
      }
      html += '<tr><th style="border:1px solid #ccc; padding:6px">Total Price</th><th style="border:1px solid #ccc; padding:6px; text-align:right">' + formatCurrency(totals.total) + '</th></tr>';
      html += '</table>';
      // End note – omit company name to keep the PDF neutral
      html += '<p style="margin-top:20px">Thank you for your business.</p>';
      const printWindow = window.open('', '_blank');
      printWindow.document.write('<html><head><title>Survey Estimate</title>');
      printWindow.document.write('<style>body{font-family:Arial, sans-serif; padding:20px;} table{width:100%; border-collapse:collapse;} th, td{border:1px solid #ccc; padding:6px;} th{background:#f5f5f5;} h1,h2{text-align:center;} </style>');
      printWindow.document.write('</head><body>');
      printWindow.document.write(html);
      printWindow.document.write('</body></html>');
      // Close document and trigger the print dialog after a slight delay to ensure content is rendered
      printWindow.document.close();
      // Focus the new window and print after a short delay
      printWindow.focus();
      setTimeout(function() {
        printWindow.print();
      }, 500);
    }
    document.getElementById('generate-pdf').addEventListener('click', generatePDF);
    showHideInputs();
    updateSummary();
  </script>
</body>
</html>